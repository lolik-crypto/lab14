import numpy as np
from neuron import SingleNeuron


# Пример данных (X - входные данные, y - целевые значения)
# Новый датасет (вес в кг, скорость в км/ч, эффективность в км/кг)
X_new = np.array([
    [10, 30, 4],   # Легкий велосипед, высокая скорость, хорошая эффективность
    [12, 25, 3],   # Хороший велосипед
    [14, 20, 2],   # Плохой велосипед
    [8, 35, 5],    # Легкий велосипед, высокая скорость, отличная эффективность
    [14, 22, 2.5], # Хороший велосипед
    [16, 15, 1.5], # Плохой велосипед
    [11, 28, 3.5]  # Хороший велосипед
])
y_new = np.array([1, 1, 0, 1, 1, 0, 1])  # 1 = хороший велосипед, 0 = плохой велосипед

# Нормализация данных
X_new = (X_new - np.mean(X_new, axis=0)) / np.std(X_new, axis=0)

# Пример дальнейшего использования
# Инициализация и обучение нейрона
neuron = SingleNeuron(input_size=3)
neuron.train(X_new, y_new, epochs=10000, learning_rate=0.001)

# Сохранение весов в файл
neuron.save_weights('neuron_weights_new.txt')